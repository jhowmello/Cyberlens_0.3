# CyberLens - Sistema Avan√ßado de Monitoramento e Seguran√ßa de Rede

## Vis√£o Geral

O CyberLens √© uma solu√ß√£o completa e avan√ßada de monitoramento e seguran√ßa de rede que combina funcionalidades de an√°lise de tr√°fego, detec√ß√£o de amea√ßas, controle parental, descoberta inteligente de dispositivos e gerenciamento de rede em uma √∫nica plataforma integrada com tecnologias de ponta.

## Arquitetura Consolidada e Otimizada

Este projeto representa a consolida√ß√£o de duas aplica√ß√µes m√≥veis (CyberLensNew e mobile) em uma solu√ß√£o unificada com backend altamente otimizado e funcionalidades avan√ßadas de rede.

### üöÄ Principais Melhorias Implementadas

#### 1. Consolida√ß√£o e Otimiza√ß√£o do Backend
- **Schema Prisma Unificado**: Consolida√ß√£o de dois schemas em uma √∫nica configura√ß√£o otimizada
- **Migra√ß√£o para PostgreSQL**: Transi√ß√£o de SQLite para PostgreSQL para melhor performance e recursos avan√ßados
- **Otimiza√ß√µes de Performance**: Implementa√ß√£o de cache, pool de conex√µes e monitoramento de queries
- **Arquitetura Modular**: Estrutura modular com separa√ß√£o clara de responsabilidades

#### 2. Sistema Avan√ßado de Performance e Monitoramento
- **PerformanceService**: Monitoramento em tempo real de queries e m√©tricas do banco
- **CacheInterceptor**: Sistema de cache inteligente para otimiza√ß√£o de consultas
- **Alertas de Performance**: Detec√ß√£o autom√°tica de queries lentas e gargalos
- **M√©tricas Detalhadas**: Coleta e an√°lise de m√©tricas de sistema e aplica√ß√£o

#### 3. **üåê NOVO: Biblioteca de Rede Otimizada e Segura**
- **SecureNetworkService**: Implementa√ß√£o de protocolos seguros (TLS 1.3, HTTPS/2, WebSocket Secure)
- **NetworkMonitoringService**: Monitoramento avan√ßado de lat√™ncia, throughput e qualidade de conex√£o
- **NetworkDiscoveryService**: Descoberta inteligente e autom√°tica de dispositivos na rede
- **RateLimitingService**: Prote√ß√£o avan√ßada contra ataques DDoS e rate limiting adaptativo
- **Connection Pooling**: Gerenciamento otimizado de conex√µes de rede
- **Cache Distribu√≠do**: Sistema de cache com Redis para otimiza√ß√£o de performance

#### 4. Configura√ß√£o Docker Otimizada
- **Multi-stage Builds**: Dockerfile otimizado para produ√ß√£o
- **Inicializa√ß√£o de Banco**: Scripts SQL para configura√ß√£o autom√°tica do PostgreSQL
- **Health Checks**: Monitoramento de sa√∫de dos containers
- **Orquestra√ß√£o Completa**: Docker Compose para ambiente completo

## Estrutura do Projeto

```
Cyberlens1.0.3/
‚îú‚îÄ‚îÄ backend/                    # API Backend (NestJS)
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/              # Autentica√ß√£o e autoriza√ß√£o
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ guards/        # Guards de seguran√ßa
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ decorators/    # Decorators customizados
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ common/            # Utilit√°rios compartilhados
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ interceptors/  # Cache e performance
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ performance/   # Monitoramento de performance
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prisma/           # Configura√ß√£o do banco
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users/            # Gerenciamento de usu√°rios
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ networks/         # Gerenciamento de redes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rules/            # Regras de seguran√ßa
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ monitoring/       # Monitoramento de dispositivos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ router/           # Integra√ß√£o com roteadores
‚îÇ   ‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schema.prisma     # Schema consolidado
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile            # Container otimizado
‚îÇ   ‚îî‚îÄ‚îÄ .dockerignore
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îî‚îÄ‚îÄ init/
‚îÇ       ‚îî‚îÄ‚îÄ 01-init.sql       # Inicializa√ß√£o PostgreSQL
‚îú‚îÄ‚îÄ CyberLensConsolidated/     # Aplica√ß√£o m√≥vel consolidada
‚îî‚îÄ‚îÄ docker-compose.yml         # Orquestra√ß√£o de containers
```

## Tecnologias Utilizadas

### Backend
- **NestJS**: Framework Node.js para APIs escal√°veis e modulares
- **Prisma**: ORM moderno para TypeScript com schema unificado
- **PostgreSQL**: Banco de dados relacional robusto e perform√°tico
- **Redis**: Cache distribu√≠do para otimiza√ß√£o de performance
- **TypeScript**: Linguagem tipada para maior seguran√ßa e produtividade

### üåê Bibliotecas de Rede Avan√ßadas
- **ws**: WebSocket seguro para comunica√ß√£o em tempo real
- **ping**: Monitoramento de lat√™ncia e conectividade
- **ioredis**: Cliente Redis otimizado para Node.js
- **node-cache**: Cache local para fallback e otimiza√ß√£o
- **netmask**: Manipula√ß√£o de redes e subnets
- **fast-speedtest-api**: Testes de velocidade de rede
- **TLS 1.3**: Protocolo de seguran√ßa mais recente
- **HTTP/2**: Protocolo HTTP otimizado para performance

### Seguran√ßa e Autentica√ß√£o
- **JWT**: Autentica√ß√£o baseada em tokens seguros
- **bcryptjs**: Hash seguro de senhas
- **Helmet**: Headers de seguran√ßa HTTP
- **Rate Limiting**: Prote√ß√£o contra ataques DDoS
- **CORS**: Controle de acesso entre origens
- **Winston**: Sistema de logging avan√ßado
- **Docker**: Containeriza√ß√£o e deploy

### Frontend Mobile
- **React Native**: Framework para desenvolvimento m√≥vel
- **Expo**: Plataforma de desenvolvimento
- **TypeScript**: Tipagem est√°tica
- **React Navigation**: Navega√ß√£o entre telas

## Configura√ß√£o e Instala√ß√£o

### Pr√©-requisitos
- Node.js 18+
- Docker e Docker Compose
- PostgreSQL (se n√£o usar Docker)

### Instala√ß√£o do Backend

```bash
cd backend
npm install
```

### Configura√ß√£o do Ambiente

Crie um arquivo `.env` no diret√≥rio `backend`:

```env
# Database
DATABASE_URL="postgresql://cyberlens:cyberlens123@localhost:5432/cyberlens"

# JWT
JWT_SECRET="your-super-secret-jwt-key"
JWT_EXPIRES_IN="24h"
JWT_REFRESH_SECRET="your-refresh-secret"
JWT_REFRESH_EXPIRES_IN="7d"

# App
PORT=3000
NODE_ENV=development

# Google OAuth (opcional)
GOOGLE_CLIENT_ID="your-google-client-id"
GOOGLE_CLIENT_SECRET="your-google-client-secret"
```

### Executando com Docker

```bash
# Iniciar todos os servi√ßos
docker-compose up -d

# Verificar logs
docker-compose logs -f

# Parar servi√ßos
docker-compose down
```

### Executando Localmente

```bash
# Gerar cliente Prisma
npm run prisma:generate

# Executar migra√ß√µes
npm run prisma:migrate

# Iniciar em desenvolvimento
npm run start:dev

# Build para produ√ß√£o
npm run build
npm run start:prod
```

## Funcionalidades Principais

### 1. Autentica√ß√£o e Autoriza√ß√£o
- Login/registro com email e senha
- Autentica√ß√£o OAuth (Google)
- Sistema de roles (ADMIN, USER, MODERATOR)
- JWT com refresh tokens
- Prote√ß√£o de rotas baseada em roles

### 2. Monitoramento de Rede
- Descoberta autom√°tica de dispositivos
- Monitoramento de tr√°fego em tempo real
- An√°lise de largura de banda
- Hist√≥rico de atividades
- Alertas de seguran√ßa

### 3. Gerenciamento de Regras
- Regras de firewall
- Controle de qualidade de servi√ßo (QoS)
- Controle parental
- Controle de acesso por dispositivo
- Agendamento de regras

### 4. Integra√ß√£o com Roteadores
- Suporte a m√∫ltiplos fabricantes
- Configura√ß√£o remota
- Monitoramento de status
- Backup e restaura√ß√£o de configura√ß√µes

### 5. Performance e Monitoramento
- Dashboard de m√©tricas em tempo real
- Monitoramento de queries do banco
- Sistema de cache inteligente
- Alertas de performance
- Relat√≥rios detalhados

## API Endpoints

### Autentica√ß√£o
```
POST /auth/register     # Registro de usu√°rio
POST /auth/login        # Login
POST /auth/refresh      # Renovar token
POST /auth/logout       # Logout
```

### Usu√°rios
```
GET  /users/profile     # Perfil do usu√°rio
PUT  /users/profile     # Atualizar perfil
DELETE /users/account   # Deletar conta
```

### Redes
```
GET    /networks        # Listar redes
POST   /networks        # Criar rede
PUT    /networks/:id    # Atualizar rede
DELETE /networks/:id    # Deletar rede
```

### Monitoramento
```
GET /monitoring/devices    # Dispositivos conectados
GET /monitoring/bandwidth  # Uso de largura de banda
GET /monitoring/activity   # Atividade da rede
GET /monitoring/stats      # Estat√≠sticas gerais
```

### üåê **NOVO: Funcionalidades Avan√ßadas de Rede**

#### Descoberta de Rede
```
GET  /network/discovery/scan        # Escanear rede para dispositivos
GET  /network/discovery/devices     # Listar dispositivos descobertos
GET  /network/discovery/device/:ip  # Detalhes de dispositivo espec√≠fico
POST /network/discovery/refresh     # Atualizar descoberta de rede
GET  /network/discovery/stats       # Estat√≠sticas de descoberta
```

#### Monitoramento Avan√ßado
```
GET  /network/monitoring/metrics    # M√©tricas de rede em tempo real
GET  /network/monitoring/latency    # Monitoramento de lat√™ncia
GET  /network/monitoring/throughput # An√°lise de throughput
GET  /network/monitoring/anomalies  # Detec√ß√£o de anomalias
GET  /network/monitoring/quality    # Qualidade da conex√£o
```

#### Rate Limiting e Seguran√ßa
```
GET  /network/rate-limit/stats      # Estat√≠sticas de rate limiting
GET  /network/rate-limit/blocked    # IPs bloqueados
POST /network/rate-limit/unblock    # Desbloquear IP
GET  /network/rate-limit/rules      # Regras de rate limiting
POST /network/rate-limit/rules      # Criar nova regra
```

#### Conex√µes Seguras
```
POST /network/secure/request        # Requisi√ß√£o HTTPS/HTTP2 segura
GET  /network/secure/websocket      # Estabelecer WebSocket seguro
GET  /network/secure/health         # Health check dos servi√ßos
GET  /network/secure/performance    # M√©tricas de performance
```

### Performance (Admin)
```
GET /performance/stats     # Estat√≠sticas de performance
GET /performance/metrics   # M√©tricas detalhadas
GET /performance/slow      # Queries lentas
POST /performance/clear    # Limpar m√©tricas
```

## Testes

```bash
# Executar todos os testes
npm test

# Testes com coverage
npm run test:cov

# Testes e2e
npm run test:e2e
```

## Deploy

### Produ√ß√£o com Docker

```bash
# Build da imagem
docker build -t cyberlens-backend .

# Executar container
docker run -p 3000:3000 --env-file .env cyberlens-backend
```

### Vari√°veis de Ambiente para Produ√ß√£o

```env
NODE_ENV=production
DATABASE_URL="postgresql://user:pass@host:5432/db"
JWT_SECRET="production-secret"
PORT=3000
```

## Monitoramento e Logs

### Logs
Os logs s√£o estruturados usando Winston e incluem:
- Requests HTTP
- Queries do banco de dados
- Erros e exce√ß√µes
- M√©tricas de performance

### M√©tricas
- Tempo de resposta das APIs
- Uso de mem√≥ria e CPU
- Queries lentas do banco
- Taxa de erro das requisi√ß√µes

## Seguran√ßa

### Medidas Implementadas
- Valida√ß√£o de entrada em todas as rotas
- Rate limiting
- CORS configurado
- Headers de seguran√ßa
- Sanitiza√ß√£o de dados
- Criptografia de senhas com bcrypt
- Tokens JWT seguros

## Contribui√ß√£o

1. Fork o projeto
2. Crie uma branch para sua feature (`git checkout -b feature/AmazingFeature`)
3. Commit suas mudan√ßas (`git commit -m 'Add some AmazingFeature'`)
4. Push para a branch (`git push origin feature/AmazingFeature`)
5. Abra um Pull Request

## Licen√ßa

Este projeto est√° licenciado sob a Licen√ßa MIT - veja o arquivo [LICENSE](LICENSE) para detalhes.

## Suporte

Para suporte e d√∫vidas:
- Abra uma issue no GitHub
- Entre em contato atrav√©s do email: suporte@cyberlens.com

## Changelog

### v1.0.3 (Atual) - Edi√ß√£o Avan√ßada de Rede
- ‚úÖ Consolida√ß√£o de schemas Prisma
- ‚úÖ Migra√ß√£o para PostgreSQL
- ‚úÖ Sistema de performance e cache
- ‚úÖ Otimiza√ß√µes Docker
- ‚úÖ Guards e decorators de autoriza√ß√£o
- ‚úÖ Testes automatizados
- ‚úÖ Documenta√ß√£o atualizada
- üåê **NOVO: Biblioteca de Rede Otimizada**
  - ‚úÖ SecureNetworkService com TLS 1.3 e HTTP/2
  - ‚úÖ NetworkMonitoringService com detec√ß√£o de anomalias
  - ‚úÖ NetworkDiscoveryService com descoberta inteligente
  - ‚úÖ RateLimitingService com prote√ß√£o DDoS adaptativa
  - ‚úÖ Connection pooling e cache distribu√≠do
  - ‚úÖ Testes abrangentes para todas as funcionalidades de rede
  - ‚úÖ Monitoramento de lat√™ncia, throughput e qualidade
  - ‚úÖ Identifica√ß√£o autom√°tica de dispositivos e servi√ßos
  - ‚úÖ Avalia√ß√£o de seguran√ßa e detec√ß√£o de vulnerabilidades

### Pr√≥ximas Vers√µes
- üîÑ Interface web administrativa
- üîÑ Integra√ß√£o com mais fabricantes de roteadores
- üîÑ Machine learning para detec√ß√£o de anomalias
- üîÑ Relat√≥rios avan√ßados e dashboards
- üîÑ API GraphQL para consultas otimizadas
- üîÑ Suporte a IPv6 completo
- üîÑ Integra√ß√£o com sistemas de SIEM